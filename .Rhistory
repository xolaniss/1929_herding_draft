align(align = "center", part = "all") %>%
align(align = "left", j = 1, part = "all") %>%
align(i = 1, align = "center") %>%
merge_at(i = 1) %>%
align(i = 7, align = "center") %>%
merge_at(i = 7) %>%
autofit(add_w = 0.6)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding ols crisis results"
#| cache: false
#| include: false
#| eval: false
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis$models$combined_regression_tbl
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
fig.pos = "H",
fig.env= 'figure',
ft.align = "left",
ft.tabcolsep= 0,
ft.latex.float = "none",
ft.arraystretch = 0.4
)
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
#| label: func
source(here("Functions","flextable_word.R" ))
source(here("Functions","modelsummary_pdf.R" ))
source(here("Functions","borderlines.R" ))
set_flextable_defaults(font.size = 7,
text.align = "left",
font.color = "black",
theme_fun = theme_apa,
padding = 0,
line_spacing = 0)
#| label: tbl-ols
#| tbl-cap: "Industry herding ols results"
#| cache: false
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
general_herding <- read_rds(here("Outputs", "artifacts_general_herding.rds"))
general_herding$models$ols_tbl %>%
ungroup() %>%
# as_grouped_data(groups = c("Category")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.6)
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl %>%
flextable()
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
flextable()
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(1, 2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.6)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(1, 2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.6)
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(1, 2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6)
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(1, 2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates)))
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(1, 2, 3, 4, 5), part = "header", value = as_paragraph(as_equation(estimates)))
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates)))
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6)
CSAD_model_rol_crisis_tbl %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.6)
combined_regression_tbl
# Description
## Analysis on crisis periods - Xolani Sibande 7 Sept 2023
# Preliminaries -----------------------------------------------------------
# core
library(tidyverse)
library(readr)
library(readxl)
library(here)
library(lubridate)
library(xts)
library(broom)
library(glue)
library(scales)
library(kableExtra)
library(pins)
library(timetk)
library(uniqtag)
library(quantmod)
# graphs
library(PNWColors)
library(patchwork)
# eda
library(psych)
library(DataExplorer)
library(skimr)
# econometrics
library(tseries)
library(strucchange)
library(vars)
library(urca)
library(mFilter)
library(car)
library(quantreg)
options(scipen = 999)
# Functions ---------------------------------------------------------------
source(here("Functions", "fx_plot.R"))
source(here("Functions", "group_ols_functions.R"))
source(here("Functions", "group_qr_functions.R"))
source(here("Functions", "group_ols_slidify_functions.R"))
dummy_crisis <- function(data_date, start_date, end_date){
ifelse(data_date > start_date & data_date < end_date, 1,0)
}
# Import -------------------------------------------------------------
result_csad_cssd <- read_rds(here("Outputs", "artifacts_descriptives.rds"))
combined_results_tbl <- result_csad_cssd$combined_results_tbl
# Dummies --------------------------------------------------------
start_gd <- as.Date("1929-01-01")
end_gd <- as.Date("1939-12-31")
start_db <- as.Date("1997-01-01")
end_db <- as.Date("2003-12-31")
start_fc <- as.Date("2007-01-01")
end_fc <- as.Date("2009-12-31")
start_cv <- as.Date("2020-01-01")
end_cv <- as.Date("2020-12-31")
dummy_tbl <- tibble(
Date  = seq(
from = as.Date("1926-07-01"),
to = as.Date("2022-07-29"),
by = "day"
),
dummy_gd = dummy_crisis(
data_date = Date,
start_date = start_gd,
end_date = end_gd
),
anti_dummy_gd = 1 - dummy_gd,
dummy_db = dummy_crisis(
data_date = Date,
start_date = start_db,
end_date = end_db
),
anti_dummy_db = 1 - dummy_db,
dummy_fc = dummy_crisis(
data_date = Date,
start_date = start_fc,
end_date = end_fc
),
anti_dummy_fc = 1 - dummy_fc,
dummy_cv = dummy_crisis(
data_date = Date,
start_date = start_cv,
end_date = end_cv
),
anti_dummy_cv = 1 - dummy_cv
)
dummy_tbl %>% fx_plot()
# Combining data sets -----------------------------------------------------
combined_results_dummy_tbl <-
combined_results_tbl %>%
left_join(dummy_tbl, by = c("Date" = "Date")) %>%
mutate(
# Great Depression
squared_market_returns_gd = `Market Return`^2,
absolute_market_returns_gd = abs(`Market Return`),
dummy_abs_gd = dummy_gd*absolute_market_returns_gd,
anti_dummy_abs_gd = anti_dummy_gd*absolute_market_returns_gd,
dummy_squared_gd = dummy_gd*squared_market_returns_gd,
anti_dummy_squared_gd = anti_dummy_gd*squared_market_returns_gd,
# Dot-come bubble
squared_market_returns_db = `Market Return`^2,
absolute_market_returns_db = abs(`Market Return`),
dummy_abs_db = dummy_db*absolute_market_returns_db,
anti_dummy_abs_db = anti_dummy_db*absolute_market_returns_db,
dummy_squared_db = dummy_db*squared_market_returns_db,
anti_dummy_squared_db = anti_dummy_db*squared_market_returns_db,
# Financial Crisis
squared_market_returns_fc = `Market Return`^2,
absolute_market_returns_fc = abs(`Market Return`),
dummy_abs_fc = dummy_fc*absolute_market_returns_fc,
anti_dummy_abs_fc = anti_dummy_fc*absolute_market_returns_fc,
dummy_squared_fc = dummy_fc*squared_market_returns_fc,
anti_dummy_squared_fc = anti_dummy_fc*squared_market_returns_fc,
# Covid crisis
squared_market_returns_cv = `Market Return`^2,
absolute_market_returns_cv = abs(`Market Return`),
dummy_abs_cv = dummy_cv*absolute_market_returns_cv,
anti_dummy_abs_cv = anti_dummy_cv*absolute_market_returns_cv,
dummy_squared_cv = dummy_cv*squared_market_returns_cv,
anti_dummy_squared_cv = anti_dummy_cv*squared_market_returns_cv
)
combined_dummy_gg <-
combined_results_dummy_tbl %>%
ggplot(aes(x = Date, y = dummy, group = Category)) +
geom_line() +
facet_wrap( . ~ Category)
# Regressions ---------------------------------------------------------------
## OLS ---------------------------------------------------------------------
### Great depression ----------------------------------------------------
formula <- as.formula(
CSAD ~ dummy_abs_gd + anti_dummy_abs_gd + dummy_squared_gd + anti_dummy_squared_gd
)
ols_gd_tbl <-
combined_results_dummy_tbl %>%
ols_group_full_workflow() %>%
relocate(dummy_abs_gd, .after = `(Intercept)`) %>%
relocate(dummy_squared_gd, .before = anti_dummy_squared_gd)
### Dot-com bubble -------------------------------------------------------
formula <- as.formula(
CSAD ~ dummy_abs_db + anti_dummy_abs_db + dummy_squared_db + anti_dummy_squared_db
)
ols_db_tbl <-
combined_results_dummy_tbl %>%
ols_group_full_workflow() %>%
relocate(dummy_abs_db, .after = `(Intercept)`) %>%
relocate(dummy_squared_db, .before = anti_dummy_squared_db)
### Financial crisis --------------------------------------------------------
formula <- as.formula(
CSAD ~ dummy_abs_fc + anti_dummy_abs_fc + dummy_squared_fc + anti_dummy_squared_fc
)
ols_fc_tbl <-
combined_results_dummy_tbl %>%
ols_group_full_workflow() %>%
relocate(dummy_abs_fc, .after = `(Intercept)`) %>%
relocate(dummy_squared_fc, .before = anti_dummy_squared_fc)
### Covid crisis ---------------------------------------------------------
formula <- as.formula(
CSAD ~ dummy_abs_cv + anti_dummy_abs_cv + dummy_squared_cv + anti_dummy_squared_cv
)
ols_cv_tbl <-
combined_results_dummy_tbl %>%
ols_group_full_workflow() %>%
relocate(dummy_abs_cv, .after = `(Intercept)`) %>%
relocate(dummy_squared_cv, .before = anti_dummy_squared_cv)
### Combined Regression -----------------------------------------------------
combined_regression_tbl <-
rbind(
ols_gd_tbl %>% rename(dummy_abs = dummy_abs_gd,
anti_dummy_abs = anti_dummy_abs_gd,
dummy_squared = dummy_squared_gd,
anti_dummy_squared = anti_dummy_squared_gd
),
ols_db_tbl %>% rename(dummy_abs = dummy_abs_db,
anti_dummy_abs = anti_dummy_abs_db,
dummy_squared = dummy_squared_db,
anti_dummy_squared = anti_dummy_squared_db
),
ols_fc_tbl %>% rename(dummy_abs = dummy_abs_fc,
anti_dummy_abs = anti_dummy_abs_fc,
dummy_squared = dummy_squared_fc,
anti_dummy_squared = anti_dummy_squared_fc
),
ols_cv_tbl %>% rename(dummy_abs = dummy_abs_cv,
anti_dummy_abs = anti_dummy_abs_cv,
dummy_squared = dummy_squared_cv,
anti_dummy_squared = anti_dummy_squared_cv
)
) %>%
ungroup()
combined_regression_tbl
c(rep("Great Depression", 6)
c(rep("Great Depression", 6))
c(rep("Great Depression", 6), rep("Dot-com Bubble", 6))
### Combined Regression -----------------------------------------------------
combined_regression_tbl <-
rbind(
ols_gd_tbl %>% rename(dummy_abs = dummy_abs_gd,
anti_dummy_abs = anti_dummy_abs_gd,
dummy_squared = dummy_squared_gd,
anti_dummy_squared = anti_dummy_squared_gd
),
ols_db_tbl %>% rename(dummy_abs = dummy_abs_db,
anti_dummy_abs = anti_dummy_abs_db,
dummy_squared = dummy_squared_db,
anti_dummy_squared = anti_dummy_squared_db
),
ols_fc_tbl %>% rename(dummy_abs = dummy_abs_fc,
anti_dummy_abs = anti_dummy_abs_fc,
dummy_squared = dummy_squared_fc,
anti_dummy_squared = anti_dummy_squared_fc
),
ols_cv_tbl %>% rename(dummy_abs = dummy_abs_cv,
anti_dummy_abs = anti_dummy_abs_cv,
dummy_squared = dummy_squared_cv,
anti_dummy_squared = anti_dummy_squared_cv
)
) %>%
ungroup() %>%
mutate(Crisis = c(rep("Great Depression", 6),
rep("Dot-com Bubble", 6),
rep("Financial Crisis", 6),
rep("Covid Crisis", 6)))
combined_regression_tbl
source("~/Papers/1929_herding_draft/Scripts/05_crisis_herding_analysis.R")
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable()
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6, 7), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
result_csad_cssd
combined_results_tbl
