bind_rows(
ols_a2_party_dummy_model_tbl,
ols_a2_fund_party_dummy_model_tbl,
ols_a2_nonfund_party_dummy_model_tbl
)
ols_party_dummy_model_tbl
marginal_effect <-
function(data, category) {
glm(formula,
family = binomial(link = "probit"),
data =  data %>%  filter(Category == category)) %>%
margins::margins(data = data)
}
industry <- list("All industries",
"Consumables",
"Health",
"Manufacturing",
"Other",
"Business services"
)
industry %>%
map(~marginal_effect(data = general_herding_a2_presidential_tbl, .x))
# Probit - General herding ---------------------------------------------------------
# function to estimating glm probit model a2_dummy on party_dummy
# get the marginal effects
formula <-  as.formula(a2_dummy ~ party_dummy + volatility)
marginal_effect <-
function(data, category) {
glm(formula,
family = binomial(link = "probit"),
data =  data %>%  filter(Category == category)) %>%
margins::margins(data = data)
}
industry <- list("All industries",
"Consumables",
"Health",
"Manufacturing",
"Other",
"Business services"
)
industry %>%
map(~marginal_effect(data = general_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date"))
, .x))
# ggplot function glm probit model a2_dummy on party_dummy
dummy_dummy_gg <-
function(dep_var = a2_dummy, data = data, category = category) {
data %>%
filter(Category == {{ category }}) %>%
ggplot(aes(x = party_dummy,
y = {{ dep_var }})) +
geom_point() +
geom_smooth(
method = "glm",
method.args = list(family = binomial(link = "probit")),
se = FALSE) +
ggtitle( {{ category }})
}
industry %>%
map(~dummy_dummy_gg(dep_var = a2_dummy, data =
general_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")) ,
.x))
industry %>%
map(~marginal_effect(data = fundamental_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")), .x))
# Probit - Fundamental herding  ---------------------------------------------------------
formula <- as.formula(a2_fund_dummy ~ party_dummy + volatility)
industry %>%
map(~marginal_effect(data = fundamental_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")), .x))
# Non-Fundamental herding - Probit ---------------------------------------------------------
formula <- as.formula(a2_nonfund_dummy ~ party_dummy + volatility)
industry %>%
map(~marginal_effect(data = non_fundamental_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")),
.x))
source("~/Papers/1929_herding_draft/Scripts/11_dummy_on_dummy.R")
ols_party_dummy_model_tbl
industry %>%
map(~marginal_effect(data = general_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")) ,
.x))
# Probit - General herding ---------------------------------------------------------
# function to estimating glm probit model a2_dummy on party_dummy
# get the marginal effects
formula <-  as.formula(a2_dummy ~ party_dummy + volatility)
industry %>%
map(~marginal_effect(data = general_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")) ,
.x))
source("~/Papers/1929_herding_draft/Scripts/11_dummy_on_dummy.R")
volatility_tbl
ols_party_dummy_model_tbl
# Probit - General herding ---------------------------------------------------------
# function to estimating glm probit model a2_dummy on party_dummy
# get the marginal effects
formula <-  as.formula(a2_dummy ~ party_dummy + volatility)
industry %>%
map(~marginal_effect(data = general_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")) ,
.x))
source("~/Papers/1929_herding_draft/Scripts/11_dummy_on_dummy.R")
source("~/Papers/1929_herding_draft/Scripts/11_dummy_on_dummy.R")
industry %>%
map(~marginal_effect(data = non_fundamental_herding_a2_presidential_tbl %>%
left_join(volatility_tbl, by = c("Date" = "Date")),
.x))
# Combined ----------------------------------------------------------------
# combine all the models
ols_party_dummy_model_tbl <-
bind_rows(
ols_a2_party_dummy_model_tbl,
ols_a2_fund_party_dummy_model_tbl,
ols_a2_nonfund_party_dummy_model_tbl
)
ols_party_dummy_model_tbl
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
fig.pos = "H",
fig.env= 'figure',
ft.align = "left",
ft.tabcolsep= 0,
ft.latex.float = "none",
ft.arraystretch = 0.4
)
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Fund")) %>%
as_flextable(hide_grouplabel = TRUE)
political$ols_party_dummy_model_tbl
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE)
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
merge_at(i = 22) %>%
align(i = 22, align = "center") %>%
merge_at(i = 29) %>%
align(i = 29, align = "center") %>%
merge_at(i = 36) %>%
align(i = 36, align = "center") %>%
merge_at(i = 43) %>%
align(i = 43, align = "center") %>%
merge_at(i = 50) %>%
align(i = 50, align = "center") %>%
autofit(add_w = 0.1)
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry"))
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
# mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
#   add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
merge_at(i = 22) %>%
align(i = 22, align = "center") %>%
merge_at(i = 29) %>%
align(i = 29, align = "center") %>%
merge_at(i = 36) %>%
align(i = 36, align = "center") %>%
merge_at(i = 43) %>%
align(i = 43, align = "center") %>%
merge_at(i = 50) %>%
align(i = 50, align = "center") %>%
autofit(add_w = 0.1)
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry"))
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
# mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
#   add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>%
# hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
merge_at(i = 22) %>%
align(i = 22, align = "center") %>%
merge_at(i = 29) %>%
align(i = 29, align = "center") %>%
merge_at(i = 36) %>%
align(i = 36, align = "center") %>%
merge_at(i = 43) %>%
align(i = 43, align = "center") %>%
merge_at(i = 50) %>%
align(i = 50, align = "center") %>%
autofit(add_w = 0.1)
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry"))
#| label: fig-political
#| fig-cap: "Herding and political cycles."
#| fig-height: 6
#| fig-width: 6
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
# mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
#   add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>%
# hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
autofit(add_w = 0.1)
#| label: tbl-political
#| tbl-cap: "Herding and political cycles."
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
# mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 6) %>%
hline_bottom(part = "footer",
border = fp_border(
color = "black",
style = "solid",
width = 1
)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
autofit(add_w = 0.5)
#| label: tbl-political
#| tbl-cap: "Herding and political cycles."
#| cache: false
political <- read_rds(here("Outputs", "artifacts_party_dummy.rds"))
political$ols_party_dummy_model_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Group")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
# mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation, " and ", equation_2), colwidths = 4) %>%
hline_bottom(part = "footer",
border = fp_border(
color = "black",
style = "solid",
width = 1
)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
autofit(add_w = 0.5)
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
fig.pos = "H",
fig.env= 'figure',
ft.align = "left",
ft.tabcolsep= 0,
ft.latex.float = "none",
ft.arraystretch = 0.4
)
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
#| label: fig-rol_fundamental
#| fig-cap: "Industry herding on fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_graphs$rol_fundamental_gg
#| label: fig-rol_nonfundamental
#| fig-cap: "Industry herding on non-fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_graphs$rol_nonfundamental_gg
CSAD_model_fundmamental <- read_rds(here("Outputs", "artifacts_fundamental_herding.rds"))
#| label: tbl-ols_fund
#| tbl-cap: "Industry herding on fundamental information"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1R_{m, t}| + \\gamma_2R_{m, t}^2 + \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
CSAD_model_fundmamental <- read_rds(here("Outputs", "artifacts_fundamental_herding.rds"))
CSAD_model_fundamental_tbl <- CSAD_model_fundmamental$ols$ols_fund_tbl
CSAD_model_fundamental_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Herd")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
autofit(add_w = 0.6)
#| label: fig-rol_fundamental
#| fig-cap: "Industry herding on fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_graphs$rol_fundamental_gg
#| label: fig-rol_fundamental
#| fig-cap: "Industry herding on fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_rol_graphs$rol_fundamental_gg
#| label: fig-rol_nonfundamental
#| fig-cap: "Industry herding on non-fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_graphs$rol_nonfundamental_gg
#| label: fig-rol_nonfundamental
#| fig-cap: "Industry herding on non-fundamental information using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
CSAD_model_fundmamental$ols_rol_graphs$rol_nonfundamental_gg
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
fig.pos = "H",
fig.env= 'figure',
ft.align = "left",
ft.tabcolsep= 0,
ft.latex.float = "none",
ft.arraystretch = 0.4
)
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
#| label: tbl-ols
#| tbl-cap: "Industry herding ols results"
#| cache: false
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
general_herding <- read_rds(here("Outputs", "artifacts_general_herding.rds"))
general_herding$models$ols_combined_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
autofit(add_w = 0.7)
