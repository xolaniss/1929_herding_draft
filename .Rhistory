equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable()
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6, 7), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
flextable() %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 7) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
autofit(add_w = 0.2)
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
result_csad_cssd
combined_results_tbl
# Description
# Preliminaries -----------------------------------------------------------
# core
library(tidyverse)
library(readr)
library(readxl)
library(here)
library(lubridate)
library(xts)
library(broom)
library(glue)
library(scales)
library(kableExtra)
library(pins)
library(timetk)
library(uniqtag)
library(quantmod)
# graphs
library(PNWColors)
library(patchwork)
# eda
library(psych)
library(DataExplorer)
library(skimr)
# econometrics
library(tseries)
library(strucchange)
library(vars)
library(urca)
library(mFilter)
library(car)
options(scipen = 999)
# Functions ---------------------------------------------------------------
source(here("Functions", "fx_plot.R"))
source(here("Functions", "group_ols_functions.R"))
source(here("Functions", "group_ols_slidify_functions.R"))
# Import -------------------------------------------------------------
result_csad_cssd <- read_rds(here("Outputs", "artifacts_descriptives.rds"))
combined_results_tbl <- result_csad_cssd$combined_results_tbl
## Top market ------------------------------------------------------------
combined_results_tbl
## Top market ------------------------------------------------------------
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = "Market Return", prop = 0.05)
## Top market ------------------------------------------------------------
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05)
## Top market ------------------------------------------------------------
ols_max_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
ungroup()
combined_results_tbl %>%
group_by(Category) %>%
slice_min(order_by = `Market Return`, prop = 0.05) %>%
ungroup()
ols_min_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_min(order_by = `Market Return`, prop = 0.05) %>%
ungroup()
## Top market ------------------------------------------------------------
ols_max_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
ungroup()
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis)
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow()
## Formula ---------------------------------------------------------------
formula <-  as.formula(CSAD ~ abs(`Market Return`) + I(`Market Return` ^ 2))
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow()
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
ungroup()
## Bottom market --------------------------------------------------------
ols_min_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_min(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
ungroup()
ols_min_tbl
## Top market ------------------------------------------------------------
ols_max_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
ungroup()
## Top market ------------------------------------------------------------
ols_max_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
mutate(Extreme = "Top") %>%
ungroup()
ols_max_tbl
## Bottom market --------------------------------------------------------
ols_min_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_min(order_by = `Market Return`, prop = 0.05) %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
mutate(Extreme = "Bottom") %>%
ungroup()
rbind(ols_max_tbl, ols_min_tbl)
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
#| label: setup
#| include: false
options(scipen=999)
knitr::opts_chunk$set(
fig.pos = "H",
fig.env= 'figure',
ft.align = "left",
ft.tabcolsep= 0,
ft.latex.float = "none",
ft.arraystretch = 0.4
)
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
#| label: tbl-ols_extreme
#| tbl-cap: "Industry herding in extreme markets"
#| cache: false
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Category")) %>%
as_flextable(hide_grouplabel = TRUE)
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE)
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE)
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates)))
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4)
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1))
#| label: tbl-ols_extreme
#| tbl-cap: "Industry herding in extreme markets"
#| cache: false
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 1=8) %>%
#| label: tbl-ols_extreme
#| tbl-cap: "Industry herding in extreme markets"
#| cache: false
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1|R_{m, t}| +  \\gamma_2R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2"
)
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
extreme_market_herding$ols$ols_extreme_market_tbl  %>%
ungroup() %>%
as_grouped_data(groups = c("Extreme")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = c(2, 3, 4), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 4) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
autofit(add_w = 0.6)
## Bottom market --------------------------------------------------------
combined_bottom_retults_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_min(order_by = `Market Return`, prop = 0.05)
ols_min_tbl <-
combined_bottom_retults_tbl %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
mutate(Extreme = "Bottom market (5% market returns)") %>%
ungroup()
ols_min_tbl
combined_top_results_tbl <-
combined_results_tbl %>%
group_by(Category) %>%
slice_max(order_by = `Market Return`, prop = 0.05)
ols_max_tbl <-
combined_top_results_tbl %>%
dplyr::select(-Crisis) %>%
ols_group_full_workflow() %>%
mutate(Extreme = "Top market (5% market returns)") %>%
ungroup()
models_max_rol <-
combined_top_results_tbl %>%
dplyr::select(-Crisis) %>%
mutate(Date = as.POSIXct(Date)) %>%
ols_slidify_models_standard() %>%
unnest_rol_col_standard(rol_column = models)
models_max_rol
rol_max_coeff_gg <-
models_max_rol %>%
dplyr::select(- starts_with("t")) %>%
slidyfy_gg_workflow_standard() +
theme(
legend.position = "none")
rol_max_coeff_gg
rol_max_tstats_gg <-
models_max_rol %>%
dplyr::select(- starts_with("a")) %>%
slidyfy_gg_workflow_standard() +
geom_hline(yintercept = 1.96, colour = "grey10", linetype = 2, linewidth = 0.3) +
geom_hline(yintercept = -1.96, colour = "grey10", linetype = 2, linewidth = 0.3)
rol_max_tstats_gg
rol_gg <- rol_coeff_gg / rol_tstats_gg
rol_max_gg <- rol_max_coeff_gg / rol_max_tstats_gg
rol_max_gg
models_min_rol <-
combined_top_results_tbl %>%
dplyr::select(-Crisis) %>%
mutate(Date = as.POSIXct(Date)) %>%
ols_slidify_models_standard() %>%
unnest_rol_col_standard(rol_column = models)
rol_min_coeff_gg <-
models_min_rol %>%
dplyr::select(- starts_with("t")) %>%
slidyfy_gg_workflow_standard() +
theme(
legend.position = "none")
rol_min_tstats_gg <-
models_min_rol %>%
dplyr::select(- starts_with("a")) %>%
slidyfy_gg_workflow_standard() +
geom_hline(yintercept = 1.96, colour = "grey10", linetype = 2, linewidth = 0.3) +
geom_hline(yintercept = -1.96, colour = "grey10", linetype = 2, linewidth = 0.3)
rol_min_gg <- rol_min_coeff_gg / rol_min_tstats_gg
rol_min_gg
source("~/Papers/1929_herding_draft/Scripts/06_exteme_market_herding_analysis.R")
extreme_market_herding <- read_rds(here("Outputs", "extreme_market_herding.rds"))
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
#| label: fig-rol_top_market
#| fig-cap: "Industry herding in top market (5% of market returns) using a 250-day rolling window. Note: The perforated lines represents a 5% level of significance."
#| fig-height: 6
#| fig-width: 8
#| cache: false
extreme_market_herding <- read_rds(here("Outputs", "artifacts_extreme_market_herding.rds"))
extreme_market_herding$rol$rol_max_gg
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry"))
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
merge_at(i = 22) %>%
align(i = 22, align = "center") %>%
autofit(add_w = 0.2)
#| label: tbl-ols_crisis
#| tbl-cap: "Industry herding in crisis periods"
#| cache: false
#| include: true
#| eval: true
equation <-  as_equation(c("CSAD_{t} = \\alpha + \\gamma_1D^{crisis}|R_{m, t}| + \\gamma_2(1-D^{crisis})|R_{m, t}| + \\gamma_3D^{crisis}R_{m, t}^2 +  \\gamma_4(1-D^{crisis})R_{m, t}^2 +  \\epsilon_{t}"))
estimates <- c(
"\\alpha",
"\\gamma_1 ",
"\\gamma_2",
"\\gamma_3 ",
"\\gamma_4"
)
CSAD_model_rol_crisis <- read_rds(here("Outputs", "artifacts_herding_crisis.rds"))
CSAD_model_rol_crisis_tbl <- CSAD_model_rol_crisis$models$combined_regression_tbl
CSAD_model_rol_crisis_tbl %>%
ungroup() %>%
as_grouped_data(groups = c("Crisis")) %>%
as_flextable(hide_grouplabel = TRUE) %>%
mk_par(i =, j = 1, part = "header", value = as_paragraph("Industry")) %>%
mk_par(i =, j = c(2, 3, 4, 5, 6), part = "header", value = as_paragraph(as_equation(estimates))) %>%
add_footer_row(values = as_paragraph("Note: The numbers in brackets are p-values. A p-value of less than 0.1 is significant", " ", ". The regressions are based on ", equation), colwidths = 6) %>%
hline_bottom(part = "footer", border = fp_border(color = "black", style = "solid", width = 1)) %>%
align(j = 1, align = "left", part = "all") %>%
merge_at(i = 1) %>%
align(i = 1, align = "center") %>%
merge_at(i = 8) %>%
align(i = 8, align = "center") %>%
merge_at(i = 15) %>%
align(i = 15, align = "center") %>%
merge_at(i = 22) %>%
align(i = 22, align = "center") %>%
autofit(add_w = 0.2)
